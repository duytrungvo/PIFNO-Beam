function [C1, C2, C3, C4, U, V, W] = coefficients_linear(BC, h1, h2, q0, q1, q2, q3, E, I0, a, b)
% solve system of linear equations 
T = zeros(4);
r = zeros(4,1);
s0 = segment(h1, h2, a);
s1 = segment(h1, h2, b);
Q0 = q0 / h2^6 / E / I0;
Q1 = Q0 * (h2^2 * q1 - h1 * h2 * q2 + h1^2 * q3);
Q2 = Q0 * (h2 * q2 - 2 * h1 * q3);
Q3 = Q0 * q3;
U = Q1 / 2;
V = Q2 / 12;
W = Q3 / 72;

if BC == "CC"
    % w(0) = 0
    T(1,1) = 1; T(1,2) = log(s0); T(1,3) = s0; T(1, 4) = 1 / s0;
    r(1,1) = -U * s0 * log(s0) - V * s0^2 - W * s0^3;
    
    % w'(0) = 0
    T(2,2) = 1 / s0; T(2,3) = 1; T(2, 4) = -1 / s0^2;
    r(2,1) = -U * log(s0) - U - 2 * V * s0 - 3 * W * s0^2;
    
    % w(L) = 0
    T(3,1) = 1; T(3,2) = log(s1); T(3,3) = s1; T(3,4) = 1 / s1;
    r(3,1) = -U * s1 * log(s1) - V * s1^2 - W * s1^3;
    
    % w'(L) = 0
    T(4,2) = 1 / s1; T(4,3) = 1; T(4,4) = -1 / s1^2;
    r(4,1) = -U * log(s1) -U - 2 * V * s1 - 3 * W * s1^2;
end
if BC == "CS"
    % w(0) = 0
    T(1,1) = 1; T(1,2) = log(s0); T(1,3) = s0; T(1, 4) = 1 / s0;
    r(1,1) = -U * s0 * log(s0) - V * s0^2 - W * s0^3;
    
    % w'(0) = 0
    T(2,2) = 1 / s0; T(2,3) = 1; T(2, 4) = -1 / s0^2;
    r(2,1) = -U * log(s0) - U - 2 * V * s0 - 3 * W * s0^2;
    
    % w(L) = 0
    T(3,1) = 1; T(3,2) = log(s1); T(3,3) = s1; T(3, 4) = 1 / s1;
    r(3,1) = -U * s1 * log(s1) - V * s1^2 - W * s1^3;
    
    % M(L) = 0
    T(4,2) = -s1; T(4,4) = 2;
    r(4,1) = -U * s1^2 - 2 * V * s1^3 - 6 * W * s1^4;
end
if BC == "SS"
    % w(0) = 0
    T(1,1) = 1; T(1,2) = log(s0); T(1,3) = s0; T(1, 4) = 1 / s0;
    r(1,1) = -U * s0 * log(s0) - V * s0^2 - W * s0^3;
    
    % M(0) = 0
    T(2,2) = -s0; T(2,4) = 2;
    r(2,1) = -U * s0^2 - 2 * V * s0^3 - 6 * W * s0^4;
    
    % w(L) = 0
    T(3,1) = 1; T(3,2) = log(s1); T(3,3) = s1; T(3, 4) = 1 / s1;
    r(3,1) = -U * s1 * log(s1) - V * s1^2 - W * s1^3;
    
    % M(L) = 0
    T(4,2) = -s1; T(4,4) = 2;
    r(4,1) = -U * s1^2 - 2 * V * s1^3 - 6 * W * s1^4;
end
if BC == "CF"
    % w(0) = 0    
    T(1,1) = 1; T(1,2) = log(s0); 
    T(1,3) = s0; T(1, 4) = 1 / s0;
    r(1,1) = -U * s0 * log(s0) - V * s0^2 - W * s0^3;

    % w'(0) = 0    
    T(2,2) = 1 / s0; T(2,3) = 1; T(2, 4) = -1 / s0^2;
    r(2,1) = -U * log(s0) - U - 2 * V * s0 - 3 * W * s0^2;
    
    % M(L) = 0    
    T(3,2) = -s1; T(3,4) = 2;
    r(3,1) = -U * s1^2 - 2 * V * s1^3 - 6 * W * s1^4;
    
    % V(L) = 0    
    T(4,2) = -1;
    r(4,1) = -2 * U * s1 - 6 * V * s1^2 - 24 * W * s1^3;
end
x = T\r;
C1 = x(1); C2 = x(2); C3 = x(3); C4 = x(4);
end
